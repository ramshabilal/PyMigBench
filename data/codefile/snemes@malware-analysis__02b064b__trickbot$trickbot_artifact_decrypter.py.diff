diff --git a/trickbot/trickbot_artifact_decrypter.py b/trickbot/trickbot_artifact_decrypter.py
        index e832d724b5f7af7a734815796de8eea919de1635..02b064b4acc0ae26d6c61246ab3f1f45b750091a 100644
        --- a/trickbot/trickbot_artifact_decrypter.py
        +++ b/trickbot/trickbot_artifact_decrypter.py
@@ -7,11 +7,11 @@ import os
 import struct
 import sys
 
-# run "python3 -m pip install -r requirements.txt" if you are missing these
-from Crypto.Cipher import AES
-from Crypto.Hash import SHA256, SHA384
-from Crypto.PublicKey import ECC
-from Crypto.Signature import DSS
+# run "sudo -H python3 -m pip install -r requirements.txt" if you are missing these
+from Cryptodome.Cipher import AES
+from Cryptodome.Hash import SHA256, SHA384
+from Cryptodome.PublicKey import ECC
+from Cryptodome.Signature import DSS
 
 logging.basicConfig(format='%(message)s', level=logging.INFO, stream=sys.stderr)
 log = logging.getLogger()
@@ -162,12 +162,15 @@ def probe_config_file(filepath, dumpdir):
                 data = xor(base64_decode(line, b64alphabet), bot_key)
                 config = decrypt_data(data)
             elif group_tag and client_id and config:
-                log.info('    [+] Group tag: %r', group_tag)
-                log.info('    [+] Client ID: %r', client_id)
-                log.info('    [+] Configuration: %r', config.decode())
-                with open(os.path.join(dumpdir, 'config.xml'), 'wb') as f:
-                    f.write(config)
-                return bot_key
+                break
+
+    if group_tag and client_id and config:
+        log.info('    [+] Group tag: %r', group_tag)
+        log.info('    [+] Client ID: %r', client_id)
+        log.info('    [+] Configuration: %r', config.decode())
+        with open(os.path.join(dumpdir, 'config.xml'), 'wb') as f:
+            f.write(config)
+        return bot_key
 
     return None
 
